<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AccuFinder Pro - AI Powered Sports Accumulators</title>
    <meta name="description" content="AI-powered high-probability sports accumulator finder using Gemini AI">
    <meta name="keywords" content="sports betting, accumulators, AI, gemini, football, basketball">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="AccuFinder Pro - AI Powered">
    <meta property="og:description" content="Find high-probability sports accumulators with AI">
    <meta property="og:type" content="website">
    
    <style>
        /* === COMPLETE STYLING === */
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
        }
        
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
            background: #0f172a; 
            color: white; 
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .header { 
            background: linear-gradient(135deg, #1e40af, #1e3a8a);
            padding: 20px 15px; 
            text-align: center; 
            border-bottom: 2px solid #334155;
        }
        
        .header h1 { 
            font-size: 24px; 
            margin-bottom: 5px; 
        }
        
        .header p { 
            color: #cbd5e1; 
            font-size: 14px; 
        }
        
        .tabs { 
            display: flex; 
            background: #1e293b; 
            border-bottom: 1px solid #334155;
        }
        
        .tab { 
            flex: 1; 
            padding: 15px 10px; 
            background: #374151; 
            color: #cbd5e1; 
            border: none; 
            font-size: 14px; 
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .tab.active { 
            background: #2563eb; 
            color: white; 
            font-weight: bold; 
        }
        
        .section { 
            display: none; 
            padding: 15px; 
        }
        
        .section.active { 
            display: block; 
        }
        
        .container { 
            max-width: 100%; 
        }
        
        .acca-card { 
            background: #1e293b; 
            margin-bottom: 15px; 
            padding: 15px; 
            border-radius: 12px; 
            border: 1px solid #334155; 
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .acca-header { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin-bottom: 15px; 
            padding-bottom: 10px; 
            border-bottom: 1px solid #334155; 
        }
        
        .odds { 
            background: #059669; 
            color: white; 
            padding: 6px 12px; 
            border-radius: 20px; 
            font-weight: bold; 
            font-size: 14px; 
        }
        
        .game { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            padding: 10px 0; 
            border-bottom: 1px solid #334155; 
        }
        
        .game:last-child { 
            border-bottom: none; 
        }
        
        .teams { 
            flex: 1; 
            font-size: 14px; 
        }
        
        .confidence { 
            display: flex; 
            align-items: center; 
            gap: 10px; 
        }
        
        .confidence-bar { 
            width: 60px; 
            height: 6px; 
            background: #374151; 
            border-radius: 3px; 
            overflow: hidden;
        }
        
        .confidence-fill { 
            height: 100%; 
            border-radius: 3px; 
            transition: width 0.3s ease;
        }
        
        .high { background: #10b981; width: 85%; }
        .medium { background: #f59e0b; width: 75%; }
        .low { background: #ef4444; width: 60%; }
        
        .add-button { 
            width: 100%; 
            background: linear-gradient(135deg, #10b981, #059669);
            color: white; 
            border: none; 
            padding: 15px; 
            border-radius: 8px; 
            margin-top: 15px; 
            font-weight: bold; 
            font-size: 16px; 
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .add-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
        }
        
        .add-button:disabled {
            background: #6b7280;
            cursor: not-allowed;
            transform: none;
        }
        
        .loading { 
            text-align: center; 
            padding: 20px; 
            color: #cbd5e1; 
        }
        
        .error { 
            background: #dc2626; 
            color: white; 
            padding: 10px; 
            border-radius: 8px; 
            margin: 10px 0; 
        }
        
        .api-key-section {
            background: #1e293b;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border: 1px solid #334155;
        }
        
        .api-key-input {
            width: 100%;
            padding: 10px;
            border-radius: 6px;
            border: 1px solid #4b5563;
            background: #374151;
            color: white;
            margin: 10px 0;
            font-family: monospace;
        }
        
        .success {
            background: #059669;
            color: white;
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>‚ö° AccuFinder Pro</h1>
        <p>AI-Powered High-Probability Accumulators</p>
    </div>
    
    <div class="tabs">
        <button class="tab active" onclick="showSection('accumulators')">ü§ñ AI Accumulators</button>
        <button class="tab" onclick="showSection('settings')">‚öôÔ∏è Settings</button>
    </div>
    
    <!-- AI Accumulators Section -->
    <div id="accumulators" class="section active">
        <div class="container">
            <div class="acca-card">
                <div class="acca-header">
                    <span>üéØ AI Accumulator Finder</span>
                    <span class="odds">Gemini Powered</span>
                </div>
                
                <p>Find high-probability accumulators across all sports using AI analysis.</p>
                
                <div id="ai-results">
                    <div class="loading" id="loading-section">
                        <p>Click below to find AI-powered accumulator opportunities</p>
                    </div>
                </div>
                
                <button class="add-button" onclick="findAccumulatorsWithGemini()" id="find-button">
                    ü§ñ Find AI Accumulators
                </button>
            </div>
            
            <div id="results-container"></div>
        </div>
    </div>
    
    <!-- Settings Section -->
    <div id="settings" class="section">
        <div class="container">
            <div class="acca-card">
                <div class="acca-header">
                    <span>‚öôÔ∏è API Settings</span>
                </div>
                
                <div class="api-key-section">
                    <label for="api-key">Your Gemini API Key:</label>
                    <input type="password" id="api-key" class="api-key-input" 
                           placeholder="Enter your Gemini API key here" 
                           value="">
                    <p style="font-size: 12px; color: #cbd5e1; margin-top: 5px;">
                        Get your free API key from <a href="https://aistudio.google.com/" style="color: #60a5fa;" target="_blank">Google AI Studio</a>
                    </p>
                </div>
                
                <button class="add-button" onclick="saveApiKey()">
                    üíæ Save API Key
                </button>
            </div>
            
            <div class="acca-card">
                <div class="acca-header">
                    <span>üîß Test Connection</span>
                </div>
                <p>Test if your Gemini API key is working correctly.</p>
                <button class="add-button" onclick="testGeminiConnection()">
                    üß™ Test Gemini API
                </button>
                <div id="test-result"></div>
            </div>
        </div>
    </div>

    <script type="module">
        // === COMPLETE GEMINI API INTEGRATION ===
        
        // Configuration
        const GEMINI_API_URL = 'https://generativelanguage.googleapis.com/v1/models/gemini-pro:generateContent';
        
        // Load saved API key
        function loadApiKey() {
            const savedKey = localStorage.getItem('gemini_api_key');
            if (savedKey) {
                document.getElementById('api-key').value = savedKey;
            }
            return savedKey;
        }
        
        // Save API key
        function saveApiKey() {
            const apiKey = document.getElementById('api-key').value.trim();
            if (apiKey) {
                localStorage.setItem('gemini_api_key', apiKey);
                showMessage('‚úÖ API Key saved successfully!', 'success');
            } else {
                showMessage('‚ùå Please enter a valid API key', 'error');
            }
        }
        
        // Show message
        function showMessage(message, type) {
            const messageDiv = document.createElement('div');
            messageDiv.className = type === 'success' ? 'success' : 'error';
            messageDiv.textContent = message;
            document.querySelector('.api-key-section').appendChild(messageDiv);
            setTimeout(() => messageDiv.remove(), 3000);
        }
        
        // Show/hide sections
        function showSection(sectionName) {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.getElementById(sectionName).classList.add('active');
            event.target.classList.add('active');
        }
        
        // Main function to find accumulators with Gemini
        async function findAccumulatorsWithGemini() {
            const button = document.getElementById('find-button');
            const resultsContainer = document.getElementById('results-container');
            const loadingSection = document.getElementById('loading-section');
            
            // Get API key
            const apiKey = loadApiKey();
            if (!apiKey) {
                showMessage('‚ùå Please set your Gemini API key in Settings first', 'error');
                showSection('settings');
                return;
            }
            
            // UI updates
            button.textContent = 'ü§î AI is analyzing games...';
            button.disabled = true;
            loadingSection.innerHTML = `
                <div style="text-align: center;">
                    <p>üîç AI is scanning thousands of games across all sports...</p>
                    <p style="font-size: 12px; margin-top: 10px;">Analyzing team form, statistics, and probabilities</p>
                </div>
            `;
            
            try {
                // Create the prompt for Gemini
                const prompt = `ACT AS A PROFESSIONAL SPORTS BETTING ANALYST. 

TASK: Find 2-3 high-probability accumulator opportunities for the next 24 hours.

REQUIREMENTS:
- 4-6 games per accumulator
- Combined odds between 5.0-10.0
- Minimum 70% confidence per game
- Include football, basketball, tennis - ALL sports
- Look beyond popular leagues
- Focus on statistically likely outcomes

OUTPUT FORMAT: Return ONLY valid JSON like this:
{
  "accumulators": [
    {
      "name": "5-Game Football Accumulator",
      "total_odds": 6.5,
      "sport": "Football",
      "games": [
        {
          "teams": "Manchester City vs Crystal Palace",
          "confidence": 0.85,
          "reasoning": "City strong at home, Palace poor away form"
        }
      ]
    }
  ]
}

ANALYZE CURRENT GAMES AND RETURN 2-3 ACCUMULATOR OPTIONS:`;
                
                // Call Gemini API
                const response = await fetch(`${GEMINI_API_URL}?key=${apiKey}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: prompt
                            }]
                        }]
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`API error: ${response.status}`);
                }
                
                const data = await response.json();
                const geminiResponse = data.candidates[0].content.parts[0].text;
                
                // Parse Gemini response
                const jsonMatch = geminiResponse.match(/\{[\s\S]*\}/);
                if (!jsonMatch) {
                    throw new Error('Could not parse AI response. Please try again.');
                }
                
                const accumulatorsData = JSON.parse(jsonMatch[0]);
                displayAccumulatorResults(accumulatorsData.accumulators);
                
            } catch (error) {
                console.error('Error:', error);
                resultsContainer.innerHTML = `
                    <div class="error">
                        ‚ùå Error: ${error.message}
                        <br><br>
                        <strong>Troubleshooting:</strong>
                        <br>‚Ä¢ Check your API key in Settings
                        <br>‚Ä¢ Ensure you have internet connection
                        <br>‚Ä¢ Try again in a few moments
                    </div>
                `;
            } finally {
                button.textContent = 'ü§ñ Find AI Accumulators';
                button.disabled = false;
            }
        }
        
        // Display results from Gemini
        function displayAccumulatorResults(accumulators) {
            const container = document.getElementById('results-container');
            
            if (!accumulators || accumulators.length === 0) {
                container.innerHTML = '<div class="error">‚ùå No accumulators found. Try again later.</div>';
                return;
            }
            
            let html = '';
            
            accumulators.forEach((acca, index) => {
                html += `
                <div class="acca-card">
                    <div class="acca-header">
                        <span>${acca.name || `AI Accumulator ${index + 1}`}</span>
                        <span class="odds">${acca.total_odds || 'N/A'}</span>
                    </div>
                    
                    <div style="font-size: 12px; color: #cbd5e1; margin-bottom: 10px;">
                        Sport: ${acca.sport || 'Multiple'} | ${acca.games.length} games
                    </div>`;
                
                acca.games.forEach((game, gameIndex) => {
                    const confidenceClass = game.confidence >= 0.8 ? 'high' : 
                                          game.confidence >= 0.7 ? 'medium' : 'low';
                    
                    html += `
                    <div class="game">
                        <div class="teams">
                            <div><strong>${game.teams}</strong></div>
                            <div style="font-size: 12px; color: #cbd5e1;">${game.reasoning || 'AI analysis'}</div>
                        </div>
                        <div class="confidence">
                            <div class="confidence-bar">
                                <div class="confidence-fill ${confidenceClass}"></div>
                            </div>
                            <span class="confidence-text">${Math.round(game.confidence * 100)}%</span>
                        </div>
                    </div>`;
                });
                
                html += `
                    <button class="add-button" onclick="addToSlip(this, ${index})">
                        ‚úÖ Add to Bet Slip
                    </button>
                </div>`;
            });
            
            container.innerHTML = html;
        }
        
        // Test Gemini connection
        async function testGeminiConnection() {
            const apiKey = loadApiKey();
            const testResult = document.getElementById('test-result');
            
            if (!apiKey) {
                testResult.innerHTML = '<div class="error">‚ùå No API key found. Please save your API key first.</div>';
                return;
            }
            
            testResult.innerHTML = '<div class="loading">Testing connection to Gemini API...</div>';
            
            try {
                const response = await fetch(`${GEMINI_API_URL}?key=${apiKey}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: "Respond with 'API connection successful' if you receive this message."
                            }]
                        }]
                    })
                });
                
                if (response.ok) {
                    testResult.innerHTML = '<div class="success">‚úÖ Gemini API connection successful! Your app is ready.</div>';
                } else {
                    throw new Error(`API returned status: ${response.status}`);
                }
            } catch (error) {
                testResult.innerHTML = `<div class="error">‚ùå Connection failed: ${error.message}</div>`;
            }
        }
        
        // Add to bet slip function
        function addToSlip(button, accaIndex) {
            const originalText = button.textContent;
            button.textContent = 'üéâ Added to Bet Slip!';
            button.style.background = 'linear-gradient(135deg, #6366f1, #4f46e5)';
            button.disabled = true;
            
            setTimeout(() => {
                button.textContent = originalText;
                button.style.background = 'linear-gradient(135deg, #10b981, #059669)';
                button.disabled = false;
            }, 2000);
        }
        
        // Initialize the app
        function initApp() {
            loadApiKey();
            console.log('‚ö° AccuFinder Pro initialized with Gemini AI');
        }
        
        // Start the app
        initApp();
    </script>
</body>
</html>
